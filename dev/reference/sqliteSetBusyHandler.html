<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Configure what SQLite should do when the database is locked — sqliteSetBusyHandler • RSQLite</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Configure what SQLite should do when the database is locked — sqliteSetBusyHandler"><meta property="og:description" content="When a transaction cannot lock the database, because it is already
locked by another one, SQLite by default throws an error:
database is locked. This behavior is usually not appropriate when
concurrent access is needed, typically when multiple processes write to
the same database.
sqliteSetBusyHandler() lets you set a timeout or a handler for these
events. When setting a timeout, SQLite will try the transaction multiple
times within this timeout. To set a timeout, pass an integer scalar to
sqliteSetBusyHandler().
Another way to set a timeout is to use a PRAGMA, e.g. the SQL queryPRAGMA busy_timeout=3000

sets the busy timeout to three seconds."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RSQLite</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">2.2.9.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/RSQLite.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/r-dbi/RSQLite/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Configure what SQLite should do when the database is locked</h1>
    <small class="dont-index">Source: <a href="https://github.com/r-dbi/RSQLite/blob/HEAD/R/SQLiteConnection.R" class="external-link"><code>R/SQLiteConnection.R</code></a></small>
    <div class="hidden name"><code>sqliteSetBusyHandler.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>When a transaction cannot lock the database, because it is already
locked by another one, SQLite by default throws an error:
<code>database is locked</code>. This behavior is usually not appropriate when
concurrent access is needed, typically when multiple processes write to
the same database.</p>
<p><code>sqliteSetBusyHandler()</code> lets you set a timeout or a handler for these
events. When setting a timeout, SQLite will try the transaction multiple
times within this timeout. To set a timeout, pass an integer scalar to
<code>sqliteSetBusyHandler()</code>.</p>
<p>Another way to set a timeout is to use a <code>PRAGMA</code>, e.g. the SQL query</p><div class="sourceCode sql"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>PRAGMA busy_timeout<span class="op">=</span><span class="dv">3000</span></span></code></pre><p></p></div>
<p>sets the busy timeout to three seconds.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">sqliteSetBusyHandler</span><span class="op">(</span><span class="va">dbObj</span>, <span class="va">handler</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dbObj</dt>
<dd><p>A <a href="SQLiteConnection-class.html">SQLiteConnection</a> object.</p></dd>
<dt>handler</dt>
<dd><p>Specifies what to do when the database is locked by
another transaction. It can be:</p><ul><li><p><code>NULL</code>: fail immediately,</p></li>
<li><p>an integer scalar: this is a timeout in milliseconds that corresponds
to <code>PRAGMA busy_timeout</code>,</p></li>
<li><p>an R function: this function is called with one argument, see details
below.</p></li>
</ul></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Invisible <code>NULL</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Note that SQLite currently does <em>not</em> schedule concurrent transactions
fairly. If multiple transactions are waiting on the same database,
any one of them can be granted access next. Moreover, SQLite does not
currently ensure that access is granted as soon as the database is
available. Make sure that you set the busy timeout to a high enough
value for applications with high concurrency and many writes.</p>
<p>If the <code>handler</code> argument is a function, then it is used as a callback
function. When the database is locked, this will be called with a single
integer, which is the number of calls for same locking event. The
callback function must return an integer scalar. If it returns <code>0L</code>,
then no additional attempts are made to access the database, and
an error is thrown. Otherwise another attempt is made to access the
database and the cycle repeats.</p>
<p>Handler callbacks are useful for debugging concurrent behavior, or to
implement a more sophisticated busy algorithm. The latter is currently
considered experimental in RSQLite. If the callback function fails, then
RSQLite will print a warning, and the transaction is aborted with a
"database is locked" error.</p>
<p>Note that every database connection has its own busy timeout or handler
function.</p>
<p>Calling <code>sqliteSetBusyHandler()</code> on a connection that is not connected
is an error.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://www.sqlite.org/c3ref/busy_handler.html" class="external-link">https://www.sqlite.org/c3ref/busy_handler.html</a></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://krlmlr.info" class="external-link">Kirill Müller</a>, <a href="http://hadley.nz" class="external-link">Hadley Wickham</a>, David A. James, Seth Falcon, <a href="https://www.r-consortium.org" class="external-link">R Consortium</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

